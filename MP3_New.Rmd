---
title: "Rocks, Tree Stumps, and Branches, Oh My!"
author: "Sameera Jhunjhunwala, Zoya Alam, Khulood Fahim"
date: "4/15/2019"
output: 
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(macleish)
library(tidyverse)
library(tidycensus)
library(sf)
library(ggplot2)
library(leaflet)
library(dplyr)
library(sp)
```

Word count: `r wordcountaddin::word_count()`

From our group repository [^1]


After visiting the various trails at Macleish field station, our group found that the facility currently lacks a ‘safety trail’ that is both handicapped accessible and child-friendly. Whilst walking on the trails we noticed and took pictures of the following trail safety hazards: rocks, branches, and tree stumps. **Based on our observations and findings, we designed a trail that aims to provide macleish with a safe trail that can be used by all visitors for biking and walking and, specifically, caters to any children as well as handicapped individuals**. 



![*Branch*](http://oi68.tinypic.com/wrchv4.jpg)


![*Rock*](http://oi66.tinypic.com/2ijb6d.jpg)

![*Tree Stump*](http://oi64.tinypic.com/21l4cg6.jpg)

We designed the trail to be in, based on our opinion, the more scenic area of the field station. And, this trail intersects with the White Loop and the Porcupine Trail. This allows us to  minimize construction cost and also allows visitors to easily access neighboring trails. Additionally, the  trail runs parallel to  a stream and also passes  the Sugar Maple Forest, Red  Oak-Hemlock Forest, and Hemlock  Forest. This gives  visitors  the opportunity to see a wide  range of biodiversity

Based on informal conversations with student interns from CEEDs, we found out that the current trails at Macleish have very few visitors. Althugh Macleish has already invested a great amount of human capital as well as financial and technological resources into the creation of numerous trails, we believe that the lack of a 'safety trail' is inhibiting the facility from maximizing its customer outreach. And, while this trail is an expensive investment, it is necessary and  will likely bring more visitors and ensure that the facility is inclusive and accessible to a wide range of demographics. 

Cost breakdown: 

Student and Construction labor: 
Cost of materials: 

Our estimate is that this trail will take three months to build and will likely be constructed during the summer months of June, July, and August. We believe that student interns as well as local construction workers could assist in building the trail. 



```{r}
#install.packages("lwgeom")
macleish_layers %>% 
  pluck("trails")
```

```{r}
boundaries_aea <- macleish_layers %>% 
  pluck("boundary")

mac_forest <- macleish_layers %>% 
  pluck("forests") %>% 
  mutate(computed_area = st_area(geometry)) %>% 
  arrange(desc(computed_area))
```

```{r}
stream_buffer <- macleish_layers %>% 
  pluck("streams") %>%
  st_transform(4326)

leaflet() %>% 
  addTiles() %>% 
  addPolylines(data = pluck(macleish_layers, "streams"), 
               weight = 1, color = "black") %>% 
  addPolylines(data = stream_buffer)
```

```{r}
buildings_buffer <- macleish_layers %>% 
  pluck("buildings") %>%
  st_transform(4326)

leaflet() %>% 
  addTiles() %>% 
  addPolylines(data = pluck(macleish_layers, "buildings"), 
               weight = 1, color = "brown") %>% 
  addPolylines(data = buildings_buffer)
```

```{r}
trails_buffer <- macleish_layers %>% 
  pluck("trails") %>%
  st_transform(4326)

leaflet() %>% 
  addTiles() %>% 
  addPolylines(data = pluck(macleish_layers, "trails"), 
               weight = 1, label = ~name, color = ~color) %>% 
  addPolylines(data = trails_buffer)
```

```{r}
forests_buffer <- macleish_layers %>% 
  pluck("forests") %>%
  st_transform(4326)

leaflet() %>% 
  addTiles() %>% 
  addPolylines(data = pluck(macleish_layers, "forests"), 
               weight = 1, color = "black") %>% 
  addPolylines(data = forests_buffer)
```

```{r}
leaflet() %>% 
  addTiles() %>% 
  addPolygons(data = macleish_layers[["forests"]],
               weight = 1, popup = ~Sheet1__Na) %>% 
  addPolylines(data = forests_buffer) %>% 
  addPolylines(data = pluck(macleish_layers, "streams"), 
               weight = 1, color = "red") %>% 
  addPolylines(data = stream_buffer)
```



```{r}
intersections <- macleish_layers %>%
  pluck("trails") %>%
  st_intersection(pluck(macleish_layers ,"streams"))
```

```{r}
intersections_forest_streams <- macleish_layers %>%
  pluck("forests") %>%
  st_intersection(pluck(macleish_layers ,"streams"))
```

```{r}

forest_pal <- colorFactor("Greens", macleish_layers[["forests"]]$Sheet1__Na)
#streams_col <- colorFactor("Reds", macleish_layers[["streams"]]$Id) 
#buildings_col <- colorFactor("Reds", macleish_layers[["buildings"]]$geometry)
```


```{r}
my_points <- tribble(
  ~point, ~lat, ~lon,
  "A", -72.682988, 42.449998,
  "B", -72.682533, 42.450209,
  "C", -72.682420, 42.452236,
  "D", -72.682426, 42.452888,
  "E", -72.682950, 42.454380,
  "F", -72.684968, 42.455187
) 

```

```{r}
my_sf <- my_points %>%
  st_as_sf(coords = c("lat", "lon"))
```

```{r}
macleish_layers %>%
  leaflet() %>%
  addTiles() %>%
  addPolygons(data = macleish_layers[["boundary"]], weight = 2, fillOpacity = 0.01) %>%
  addPolygons(data = macleish_layers[["forests"]], weight = 4, color = ~forest_pal, popup = ~Sheet1__Na) %>%
  addPolylines(data = pluck(macleish_layers, "streams"), 
               weight = 2, color = "black") %>% 
  addPolygons(data = pluck(macleish_layers, "buildings"), 
               weight = 2, color = "dark red") %>% 
  addPolylines(data = macleish_layers[["forests"]],
               weight = 1, popup = ~Sheet1__Na) %>% 
  addPolylines(data = pluck(macleish_layers, "trails"), 
               weight = 1, color = ~color) %>% 
  addPolylines(data = my_points, lat = ~lon, lng = ~lat) %>%  
  #addMarkers(data = st_cast(intersections, "POINT"), popup = ~name ) %>% 
  addMarkers(data = my_sf, popup = ~point) %>% 
  addPolygons(data = macleish_layers[["research"]], weight = 1) 
```


``` {r}
intersections_filtered <- intersections_filtered %>% 
  separate(col = geometry, into = c('Latitude', 'Longitude '), sep = '\\,')
```


